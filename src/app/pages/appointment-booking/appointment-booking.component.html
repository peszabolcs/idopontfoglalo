<mat-card class="appointment-container">
  <mat-card-header>
    <mat-card-title>Időpontfoglalás</mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <form
      [formGroup]="appointmentForm"
      (ngSubmit)="onSubmit()"
      class="appointment-form"
    >
      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Ügyintézési típus</mat-label>
        <mat-select formControlName="service">
          <mat-option *ngFor="let service of services" [value]="service.value">
            {{ service.viewValue }}
          </mat-option>
        </mat-select>
        <mat-error
          *ngIf="
            appointmentForm.get('service')?.invalid &&
            appointmentForm.get('service')?.touched
          "
        >
          A szolgáltatás kiválasztása kötelező
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Dátum</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          formControlName="date"
          [min]="minDate"
        />
        <mat-datepicker-toggle
          matIconSuffix
          [for]="picker"
        ></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        <mat-error
          *ngIf="
            appointmentForm.get('date')?.invalid &&
            appointmentForm.get('date')?.touched
          "
        >
          A dátum megadása kötelező
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Időpont</mat-label>
        <mat-select formControlName="time">
          <mat-option *ngFor="let time of availableTimes" [value]="time">
            {{ time }}
          </mat-option>
        </mat-select>
        <mat-error
          *ngIf="
            appointmentForm.get('time')?.invalid &&
            appointmentForm.get('time')?.touched
          "
        >
          Az időpont kiválasztása kötelező
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Megjegyzés</mat-label>
        <textarea
          matInput
          formControlName="notes"
          placeholder="További megjegyzések..."
        ></textarea>
      </mat-form-field>

      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="appointmentForm.invalid || isLoading"
        class="submit-button"
      >
        <mat-spinner
          *ngIf="isLoading"
          diameter="24"
          color="accent"
        ></mat-spinner>
        <span *ngIf="!isLoading">Időpont foglalása</span>
      </button>
    </form>
  </mat-card-content>
</mat-card>
